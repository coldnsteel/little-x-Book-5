 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Little X and Justice for All - Book 5</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1a0033 0%, #2d1b4e 50%, #1a1a2e 100%);
            color: white;
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
        }
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s infinite alternate;
        }
        @keyframes twinkle {
            0% { opacity: 0.3; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.2); }
        }
        @keyframes float-up {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-100px) scale(1.5); }
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        @keyframes guest-pop {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes gavel-bang {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-15deg); }
            75% { transform: rotate(15deg); }
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
            z-index: 10;
        }
        h1 {
            text-align: center;
            font-size: 2.5em;
            text-shadow: 0 0 20px #FFD700;
            animation: glow 2s ease-in-out infinite alternate;
            margin-bottom: 10px;
        }
        @keyframes glow {
            from { text-shadow: 0 0 20px #FFD700; }
            to { text-shadow: 0 0 30px #FFD700, 0 0 40px #FFA500; }
        }
        .chapter {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #FFD700;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            line-height: 1.8;
        }
        .chapter h2 {
            color: #FFD700;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .gavel {
            display: inline-block;
            animation: gavel-bang 2s ease-in-out infinite;
        }
        .chalkboard-container {
            background: rgba(255, 215, 0, 0.2);
            border: 3px dashed #FFD700;
            border-radius: 15px;
            padding: 20px;
            margin: 30px 0;
            text-align: center;
            position: relative;
        }
        .btn {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            border: none;
            color: #000;
            font-weight: bold;
            padding: 12px 24px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: all 0.3s ease;
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5);
        }
        .btn:active {
            transform: translateY(-1px);
        }
        .controls, .instruments {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .story-text {
            font-size: 18px;
            margin: 20px 0;
        }
        .character-speech {
            background: rgba(255, 215, 0, 0.1);
            border-left: 4px solid #FFD700;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .guest-chat {
            background: rgba(138, 43, 226, 0.1);
            border-left: 4px solid #8a2be2;
            animation: guest-pop 1s ease-out;
        }
        .mystery-box {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 165, 0, 0.3));
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #FFD700;
            margin: 15px 0;
        }
        .evidence-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: bold;
            margin: 5px;
        }
        .direct-evidence { background: #00ff00; color: #000; }
        .hearsay-evidence { background: #ff6b9d; color: #fff; }
        .inferential-evidence { background: #8a2be2; color: #fff; }
        .nav-buttons {
            text-align: center;
            margin: 30px 0;
        }
        @media (max-width: 600px) {
            h1 { font-size: 2em; }
            .chapter { padding: 20px; }
        }
    </style>
</head>
<body>
    <div id="stars-container"></div>
    
    <div class="container">
        <h1>‚öñÔ∏è Little X and Justice for All ‚öñÔ∏è</h1>
        <p style="text-align: center; font-size: 1.2em; color: #FFD700;">Book 5 of the Little X Adventures</p>
        
        <div class="chapter">
            <h2><span class="gavel">üî®</span> Chapter 1: The Hall of Justice</h2>
            
            <div class="story-text">
                <p>After mastering cosmic codes in Book 4, the workshop swirled with golden light and transformed into a magnificent courtroom under twinkling stars! Marble columns rose majestically, and a wise owl wearing tiny round glasses and an elegant judge's robe landed gracefully on a cosmic podium.</p>
                
                <div class="character-speech">
                    <strong>Socrates Owl:</strong> "Hoot-hoot! Welcome to the Hall of Justice! I'm Socrates, guardian of wisdom and law. You've learned about the web of life and how to code solutions‚Äînow let's learn how LAWS keep our cosmic community fair and safe for everyone!"
                </div>
                
                <div class="character-speech">
                    <strong>Little X:</strong> "Laws? Like the connections in the web from Book 3, but for people?"
                </div>
                
                <p>Socrates fluffed his feathers with pride, his glasses glinting. "PRECISELY! Just as nature needs balance, society needs fair rules. Let me tell you about the Ten Commandments‚Äîancient wisdom from thousands of years ago that still guides us today!"</p>
                
                <div class="character-speech">
                    <strong>Raaarrr:</strong> "Raaarrr! Rules for playing nice in the cosmic playground?"
                </div>
                
                <div class="character-speech">
                    <strong>Socrates Owl:</strong> "Exactly, my scaly friend! Simple, timeless basics that help us all live together: Don't STEAL (no grabbing toys that aren't yours!), don't LIE (always tell the truth about who broke the vase!), don't BEAR FALSE WITNESS (never fib about what your friends did!), and don't COVET (don't desperately want someone else's shiny bike just because it's theirs!). These principles help everyone play fair together."
                </div>
                
                <div class="character-speech">
                    <strong>ARIA (appearing in a shimmering judge's robe):</strong> "And here's something fascinating! These basic rules grew into what we call COMMON LAW. When wise judges made fair decisions over centuries, those stories of justice became rules for everyone to follow. But‚Äîand this is CRITICAL‚ÄîSPECIFICS matter! Was something an accident or on purpose? Did someone borrow or steal? The MEANING of words changes EVERYTHING!"
                </div>
                
                <p>Little X's eyes widened with understanding. "So it's like debugging code‚Äîyou need to understand EXACTLY what happened!"</p>
                
                <div class="character-speech">
                    <strong>Socrates Owl:</strong> "Hooty-brilliant connection! Yes! Justice requires precision, just like coding. Now, let's practice matching these ancient rules to modern situations!"
                </div>
            </div>
            
            <div class="chalkboard-container">
                <h3>‚öñÔ∏è Ten Commandments Match-Up!</h3>
                <p>Match each rule to the correct picture. Click a rule on the left, then click the matching emoji on the right!</p>
                <canvas id="law-canvas" width="600" height="350" style="background: #1a1a2e; border: 2px solid #FFD700; border-radius: 10px; cursor: pointer; display: block; margin: 20px auto;"></canvas>
                <div id="law-message" style="margin-top: 15px; color: #FFD700; font-weight: bold;">Click "Don't Steal" on the left, then click the grabbing hand ‚úã on the right!</div>
                <div class="controls">
                    <button class="btn" onclick="clearLaw()">üîÑ New Puzzle</button>
                    <button class="btn" onclick="checkLawMatches()">‚úÖ Check My Matches!</button>
                </div>
                <div id="law-score" style="margin-top: 10px; color: #00ff00; font-size: 18px;"></div>
            </div>
            
            <div class="story-text">
                <p>Socrates hooted with delight as Little X correctly matched rules to actions. "Excellent work! Now, let's dive deeper into finding TRUTH. I'll teach you my famous method: the SOCRATIC METHOD‚Äîusing questions to dig deeper and uncover what really happened!"</p>
                
                <div class="character-speech">
                    <strong>Little X:</strong> "Questions to find truth? Like being a word detective?"
                </div>
                
                <p>"Hoot YES! SEMANTICS‚Äîthe meaning of words‚Äîis crucial! Think about this: 'Borrow' versus 'steal'? Completely different! 'I didn't take it' could mean you hid it, forgot about it, or never saw it. GRAMMAR matters too‚Äîthe way we arrange words changes meaning. Clear language brings justice!"</p>
                
                <div class="character-speech">
                    <strong>ARIA:</strong> "And we must understand three types of EVIDENCE! First: HEARSAY is gossip‚Äîwhat your friend heard from another friend who heard from someone else. Courts usually don't accept it because nobody can prove it's true. Second: DIRECT evidence means you SAW it happen with your own eyes‚Äîyou're a witness! Third: INFERENTIAL evidence means you use clues and reasoning to figure out what probably happened."
                </div>
                
                <div class="character-speech">
                    <strong>Raaarrr:</strong> "Raaarrr! Like... someone TOLD me you ate the cookie‚Äîthat's hearsay roar! But if I SEE crumbs all over your face? That's direct evidence munch-proof! And if I find your footprints leading to the cookie jar? That's inferential‚Äîclues tell the story!"
                </div>
                
                <p>Little X nodded eagerly. "So we ask questions, check the evidence, and use our reasoning skills to find the truth!"</p>
                
                <div class="character-speech">
                    <strong>Socrates Owl:</strong> "Precisely! Now let's practice with a real mystery..."
                </div>
            </div>
            
            <div class="nav-buttons">
                <button class="btn" onclick="loadChapter(2)" style="font-size: 18px; padding: 15px 30px;">
                    üîç Continue to Chapter 2: The Cookie Mystery ‚Üí
                </button>
            </div>
        </div>
        
        <div class="chapter" id="chapter2" style="display: none;">
            <h2><span class="gavel">üî®</span> Chapter 2: The Cookie Mystery & The Art of Reasoning</h2>
            
            <div class="story-text">
                <p>The courtroom sparkled as a mysterious case appeared on the cosmic screen‚ÄîUncle Harold's famous star cookie had vanished!</p>
                
                <div class="character-speech">
                    <strong>Socrates Owl:</strong> "Now we put your detective skills to the test! Someone took Uncle Harold's famous star cookie from the workshop! Use the Socratic Method‚Äîask questions, gather evidence, and reason your way to the truth!"
                </div>
                
                <div class="mystery-box">
                    <h4 style="color: #FFD700; margin-top: 0;">üç™ THE COOKIE MYSTERY</h4>
                    <p style="font-size: 18px;">Uncle Harold's prized star cookie has vanished! Three suspects remain:</p>
                    <ul style="text-align: left; display: inline-block;">
                        <li>ü¶ñ <strong>Dino</strong> - Was seen near the workshop</li>
                        <li>ü§ñ <strong>Robot</strong> - Has access to all areas</li>
                        <li>üê¶ <strong>Bird</strong> - Can fly to high shelves</li>
                    </ul>
                    <p style="margin-top: 15px;">Ask questions to gather evidence and solve the case!</p>
                </div>
            </div>
            
            <div class="chalkboard-container">
                <h3>üïµÔ∏è Socratic Question Game: Solve the Mystery!</h3>
                <p>Click buttons to ask questions. Pay attention to evidence types!</p>
                
                <div class="instruments">
                    <button class="btn" onclick="askQuestion('dino', 'alibi')">ü¶ñ Dino, where were you?</button>
                    <button class="btn" onclick="askQuestion('robot', 'motive')">ü§ñ Robot, why take a cookie?</button>
                    <button class="btn" onclick="askQuestion('bird', 'evidence')">üê¶ Bird, what about those crumbs?</button>
                </div>
                <div class="instruments">
                    <button class="btn" onclick="askQuestion('dino', 'witness')">üëÅÔ∏è Anyone see Dino?</button>
                    <button class="btn" onclick="askQuestion('robot', 'physical')">üîç Check Robot for crumbs</button>
                    <button class="btn" onclick="askQuestion('bird', 'behavior')">üé≠ Bird acting nervous?</button>
                </div>
                <div class="instruments" style="margin-top: 15px;">
                    <button class="btn" onclick="solveMystery()" style="font-size: 18px; padding: 15px 30px; background: linear-gradient(45deg, #00ff00, #32CD32);">
                        ‚ö° SOLVE THE MYSTERY!
                    </button>
                </div>
                
                <div id="question-log" style="margin-top: 15px; padding: 15px; background: rgba(0, 0, 0, 0.5); border-radius: 10px; min-height: 120px; max-height: 250px; overflow-y: auto; color: #00ff00; border: 2px solid #FFD700; text-align: left;"></div>
            </div>
            
            <div class="story-text">
                <p>As Little X gathered evidence, Socrates explained the two main types of reasoning:</p>
                
                <div class="character-speech">
                    <strong>Socrates Owl:</strong> "Excellent questioning! Now, let me teach you about REASONING. There are two powerful types: DEDUCTIVE and INDUCTIVE reasoning."
                </div>
                
                <div style="background: rgba(0, 255, 0, 0.1); padding: 20px; border-radius: 10px; border-left: 4px solid #00ff00; margin: 20px 0;">
                    <h4 style="color: #00ff00; margin-top: 0;">üî¨ DEDUCTIVE REASONING</h4>
                    <p><strong>Goes from BIG RULE to SMALL FACT</strong></p>
                    <p>Example: "All cookie thieves leave crumbs. Bird has crumbs. Therefore, Bird might be the thief!"</p>
                    <p style="color: #ffff00;">üí° Like a laser‚Äîprecise logic from general rule to specific conclusion!</p>
                </div>
                
                <div style="background: rgba(138, 43, 226, 0.1); padding: 20px; border-radius: 10px; border-left: 4px solid #8a2be2; margin: 20px 0;">
                    <h4 style="color: #8a2be2; margin-top: 0;">üîÆ INDUCTIVE REASONING</h4>
                    <p><strong>Goes from SMALL CLUES to BIG PATTERN</strong></p>
                    <p>Example: "Feather here, feather there, feathers everywhere near the cookie jar‚ÄîBird probably did something!"</p>
                    <p style="color: #ffff00;">üí° Like connecting dots‚Äîyou spot patterns and make predictions!</p>
                </div>
                
                <div class="character-speech">
                    <strong>ARIA:</strong> "Both types are crucial for justice! Deductive reasoning uses established rules and applies them. Inductive reasoning spots patterns from evidence. Together, they help us find truth!"
                </div>
                
                <div class="character-speech">
                    <strong>Little X:</strong> "So deductive is zoom-in with rules, inductive is zoom-out to see patterns?"
                </div>
                
                <p>"PERFECT!" Socrates hooted, his glasses bouncing. "You understand! Now let's practice both types with timed challenges!"</p>
            </div>
            
            <div class="chalkboard-container">
                <h3>üéØ Reasoning Time Challenge!</h3>
                <p>Test your reasoning skills! 30 seconds per round. Choose your mode!</p>
                
                <div class="instruments">
                    <button class="btn" onclick="startReasoning('deductive')" style="padding: 15px 25px; font-size: 16px;">
                        üî¨ Deductive Dash!
                    </button>
                    <button class="btn" onclick="startReasoning('inductive')" style="padding: 15px 25px; font-size: 16px;">
                        üîÆ Inductive Spot!
                    </button>
                </div>
                
                <div id="reasoning-clues" style="margin: 15px 0; background: rgba(255, 215, 0, 0.2); padding: 20px; border-radius: 10px; min-height: 120px; border: 2px solid #FFD700;">
                    <p style="color: #ffff00;">Choose a reasoning mode to begin!</p>
                </div>
                
                <div id="reasoning-timer" style="font-size: 32px; color: #FFD700; text-shadow: 0 0 10px #FFD700; margin: 10px 0;"></div>
                
                <div class="instruments">
                    <button class="btn" onclick="guessAnswer('robot')">Guess: Robot ü§ñ</button>
                    <button class="btn" onclick="guessAnswer('dino')">Guess: Dino ü¶ñ</button>
                    <button class="btn" onclick="guessAnswer('bird')">Guess: Bird üê¶</button>
                </div>
                
                <div id="reasoning-result" style="margin-top: 15px; padding: 15px; background: rgba(0, 255, 0, 0.1); border-radius: 10px; color: #00ff00; font-weight: bold; min-height: 50px; border: 2px solid #00ff00;"></div>
                
                <div id="reasoning-score" style="margin-top: 10px; font-size: 20px; color: #FFD700;">
                    Rounds Won: 0
                </div>
            </div>
            
            <div class="story-text">
                <p>Little X's brain sparkled with all this new knowledge! The courtroom filled with golden light as understanding dawned.</p>
                
                <div class="character-speech">
                    <strong>Socrates Owl:</strong> "Remember, young justice seeker: Justice isn't about being harsh‚Äîit's about being FAIR. We balance hearts and facts, personal circumstances and society's needs. We weigh evidence carefully, ask probing questions, and reason our way to truth!"
                </div>
                
                <div class="character-speech guest-chat">
                    <strong>Keanu (materializing in golden stardust):</strong> "Beautiful work, Little X. You've learned that laws are cosmic threads connecting us all‚Äîprotecting everyone and helping society grow together. Justice requires both wisdom and compassion. Creation with pure hearts mends all glitches in the universe."
                </div>
                
                <div class="character-speech">
                    <strong>Raaarrr:</strong> "Raaarrr-justice! No stealing, no fibbing, ask smart questions, check all evidence types, use deductive AND inductive reasoning! I'm a lawyer dino now! Can I have a tiny wig?"
                </div>
                
                <p>Everyone laughed as Raaarrr tried on a miniature judge's wig that Socrates conjured. It perched adorably between his horns. ARIA played a triumphant melody on cosmic instruments as the courtroom filled with sparkles.</p>
                
                <div class="character-speech">
                    <strong>ARIA:</strong> "You've come so far, Little X! From drawing dinosaurs to understanding the web of life, to coding solutions, and now protecting justice for all. You're a true cosmic citizen!"
                </div>
                
                <p>The stars above the courtroom twinkled brighter than ever, and a warm feeling filled Little X's heart. Understanding justice meant understanding how to make the world fair for everyone.</p>
                
                <p style="text-align: center; font-size: 24px; color: #FFD700; text-shadow: 0 0 20px #FFD700; margin: 30px 0;">
                    <em>‚ú® The End of Book 5... The Journey Continues! ‚ú®</em>
                </p>
                
                <div style="background: rgba(138, 43, 226, 0.2); padding: 20px; border-radius: 15px; margin: 30px 0; text-align: center;">
                    <h3 style="color: #8a2be2;">üåü You've Completed the Little X Series! üåü</h3>
                    <p style="font-size: 18px;">Across 5 amazing books, you've learned:</p>
                    <ul style="list-style: none; padding: 0; font-size: 16px;">
                        <li>üìö <strong>Book 1:</strong> Foundations & Friendship</li>
                        <li>üé® <strong>Book 2:</strong> Creative Building & Music</li>
                        <li>üåç <strong>Book 3:</strong> Web of Life & Science</li>
                        <li>üíª <strong>Book 4:</strong> Cosmic Codes & Programming</li>
                        <li>‚öñÔ∏è <strong>Book 5:</strong> Justice & Reasoning</li>
                    </ul>
                    <p style="margin-top: 20px; font-size: 18px; color: #00ffff;">
                        You're ready for ANY cosmic adventure now! üöÄ
                    </p>
                </div>
            </div>
            
            <div class="nav-buttons">
                <button class="btn" onclick="loadChapter(1)" style="font-size: 18px; padding: 15px 30px;">
                    üîÑ Restart Book 5
                </button>
                <button class="btn" onclick="celebrateCompletion()" style="background: linear-gradient(45deg, #FFD700, #FFA500, #ff6b9d, #8a2be2); font-size: 18px; padding: 15px 30px;">
                    üéâ CELEBRATE COMPLETION!
                </button>
            </div>
        </div>
    </div>

    <script>
        let audioContext = null;
        function initAudio() {
            if (!audioContext) audioContext = new (window.AudioContext || window.webkitAudioContext)();
            if (audioContext.state === 'suspended') audioContext.resume();
        }
        function playTone(freq, dur, type = 'sine') {
            initAudio();
            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            osc.connect(gain);
            gain.connect(audioContext.destination);
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioContext.currentTime);
            gain.gain.setValueAtTime(0, audioContext.currentTime);
            gain.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.01);
            gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + dur);
            osc.start(audioContext.currentTime);
            osc.stop(audioContext.currentTime + dur);
        }
        
        function createStars() {
            const container = document.getElementById('stars-container');
            for (let i = 0; i < 60; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(star);
            }
        }
        
        // LAW MATCHING GAME
        let selectedRule = null;
        let lawMatches = [];
        const lawRules = [
            {name: "Don't Steal", y: 80, emoji: '‚úã', matched: false},
            {name: "Don't Lie", y: 170, emoji: 'ü§•', matched: false},
            {name: "Don't Covet", y: 260, emoji: 'üëÄ', matched: false}
        ];
        
        function setupLawCanvas() {
            const canvas = document.getElementById('law-canvas');
            if (!canvas) return;
            canvas.addEventListener('click', handleLawClick);
            canvas.addEventListener('touchstart', (e) => { e.preventDefault(); handleLawClick(e.touches[0]); });
            drawLawPuzzle();
        }
        
        function drawLawPuzzle() {
            const canvas = document.getElementById('law-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, 600, 350);
            
            ctx.font = 'bold 20px Arial';
            lawRules.forEach((rule, index) => {
                ctx.fillStyle = rule.matched ? '#00ff00' : (selectedRule === index ? '#ffff00' : '#FFD700');
                ctx.fillText(rule.name, 50, rule.y);
                
                if (selectedRule === index) {
                    ctx.strokeStyle = '#ffff00';
                    ctx.lineWidth = 3;
                    ctx.strokeRect(40, rule.y - 25, 200, 40);
                }
            });
            
            ctx.font = '50px Arial';
            ctx.textAlign = 'center';
            lawRules.forEach((rule, index) => {
                ctx.fillStyle = rule.matched ? '#00ff00' : '#FFD700';
                ctx.fillText(rule.emoji, 500, rule.y + 10);
            });
            
            ctx.strokeStyle = '#00ff00';
            ctx.lineWidth = 3;
            lawMatches.forEach(match => {
                ctx.beginPath();
                ctx.moveTo(250, lawRules[match.rule].y);
                ctx.lineTo(450, lawRules[match.icon].y);
                ctx.stroke();
                
                // Draw sparkle on line
                const midX = 350;
                const midY = (lawRules[match.rule].y + lawRules[match.icon].y) / 2;
                ctx.font = '20px Arial';
                ctx.fillText('‚ú®', midX, midY);
            });
            
            ctx.textAlign = 'left';
        }
        
        function handleLawClick(e) {
            const canvas = document.getElementById('law-canvas');
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            if (x < 300) {
                lawRules.forEach((rule, index) => {
                    if (y >= rule.y - 25 && y <= rule.y + 15 && !rule.matched) {
                        selectedRule = index;
                        document.getElementById('law-message').textContent = `‚úÖ Selected: "${rule.name}" - Now click the matching ${rule.emoji} on the right!`;
                        initAudio();
                        playTone(440, 0.2, 'sine');
                    }
                });
            } else if (x > 400 && selectedRule !== null) {
                lawRules.forEach((rule, index) => {
                    if (y >= rule.y - 30 && y <= rule.y + 20) {
                        if (selectedRule === index) {
                            lawMatches.push({rule: selectedRule, icon: index});
                            lawRules[selectedRule].matched = true;
                            document.getElementById('law-message').textContent = `üéâ PERFECT MATCH! "${lawRules[selectedRule].name}" = ${rule.emoji} Justice prevails!`;
                            
                            initAudio();
                            playTone(523, 0.3, 'sine');
                            setTimeout(() => playTone(659, 0.3, 'sine'), 150);
                            
                            if (lawMatches.length === 3) {
                                setTimeout(() => {
                                    document.getElementById('law-message').textContent = 'üèÜ ALL MATCHED PERFECTLY! You understand justice! üèÜ';
                                    playTone(784, 0.5, 'sine');
                                    setTimeout(() => playTone(880, 0.5, 'sine'), 200);
                                }, 500);
                            }
                        } else {
                            document.getElementById('law-message').textContent = '‚ùå Not quite! Try a different emoji!';
                            initAudio();
                            playTone(349, 0.3, 'square');
                        }
                        selectedRule = null;
                    }
                });
            }
            drawLawPuzzle();
        }
        
        function clearLaw() {
            selectedRule = null;
            lawMatches = [];
            lawRules.forEach(r => r.matched = false);
            drawLawPuzzle();
            document.getElementById('law-message').textContent = 'Click a rule, then click the matching icon! ‚úãü§•üëÄ';
            document.getElementById('law-score').textContent = '';
        }
        
        function checkLawMatches() {
            const score = document.getElementById('law-score');
            if (lawMatches.length === 3) {
                score.textContent = 'üèÜ PERFECT SCORE! All laws matched correctly! Justice prevails! üèÜ';
                score.style.color = '#00ff00';
                initAudio();
                playTone(659, 0.4, 'sine');
            } else if (lawMatches.length > 0) {
                score.textContent = `Good work! ${lawMatches.length} out of 3 matched correctly. Keep going!`;
                score.style.color = '#ffff00';
            } else {
                score.textContent = 'Make some matches first by clicking rules and icons!';
                score.style.color = '#ff6b9d';
            }
        }
        
        // MYSTERY GAME
        let questionsAsked = [];
        const mysteryAnswers = {
            dino: {
                alibi: "ü¶ñ Dino: I was napping in the sun garden the whole time! ZZZzzz...",
                witness: "üå∏ Flowers: Yes, Dino was here snoring SO LOUD we couldn't grow properly!"
            },
            robot: {
                motive: "ü§ñ Robot: Cookies? I run on solar batteries and quantum circuits, not sugar! That's illogical!",
                physical: "üîç Investigation Result: Robot is completely spotless. No crumbs anywhere. Systems show no cookie consumption."
            },
            bird: {
                evidence: "üê¶ Bird: These crumbs? Um... they're from my seed snack! Definitely seeds, not cookies! *nervous chirp*",
                behavior: "üé≠ Observer Notes: Bird acting unusually nervous, avoiding eye contact, wings fidgeting constantly."
            }
        };
        
        function askQuestion(suspect, questionType) {
            const log = document.getElementById('question-log');
            const answer = mysteryAnswers[suspect][questionType];
            
            if (!answer) return;
            
            const questionEntry = document.createElement('div');
            questionEntry.style.cssText = 'margin: 8px 0; padding: 10px; background: rgba(255, 215, 0, 0.3); border-radius: 5px; border-left: 3px solid #FFD700; animation: guest-pop 0.5s ease-out;';
            
            let evidenceType = '';
            if (questionType === 'witness') {
                evidenceType = '<span class="evidence-badge direct-evidence">DIRECT EVIDENCE</span>';
            } else if (questionType === 'behavior') {
                evidenceType = '<span class="evidence-badge inferential-evidence">INFERENTIAL EVIDENCE</span>';
            } else {
                evidenceType = '<span class="evidence-badge hearsay-evidence">TESTIMONY</span>';
            }
            
            questionEntry.innerHTML = `${evidenceType}<br>${answer}`;
            log.appendChild(questionEntry);
            log.scrollTop = log.scrollHeight;
            
            questionsAsked.push({suspect, questionType});
            
            initAudio();
            playTone(392, 0.2, 'sine');
        }
        
        function solveMystery() {
            const log = document.getElementById('question-log');
            
            if (questionsAsked.length < 3) {
                const warning = document.createElement('div');
                warning.style.cssText = 'margin: 10px 0; padding: 10px; background: rgba(255, 107, 157, 0.3); border-radius: 5px; color: #ff6b9d; font-weight: bold; border: 2px solid #ff6b9d;';
                warning.textContent = '‚ö†Ô∏è A good detective gathers MORE evidence! Ask at least 3 questions before solving the case!';
                log.appendChild(warning);
                log.scrollTop = log.scrollHeight;
                
                initAudio();
                playTone(349, 0.3, 'square');
                return;
            }
            
            const solution = document.createElement('div');
            solution.style.cssText = 'margin: 15px 0; padding: 20px; background: linear-gradient(135deg, rgba(0, 255, 0, 0.3), rgba(138, 43, 226, 0.3)); border-radius: 10px; color: #00ff00; font-weight: bold; border: 3px solid #00ff00; animation: pulse 1s ease-in-out 3;';
            solution.innerHTML = `
                <div style="font-size: 22px; margin-bottom: 10px;">üîç CASE SOLVED! üîç</div>
                <div style="font-size: 18px;">The evidence points to... üê¶ <strong>BIRD</strong>! üê¶</div>
                <div style="margin-top: 15px; font-size: 15px; color: #ffff00; text-align: left;">
                    <strong>Evidence Analysis:</strong><br>
                    <span class="evidence-badge direct-evidence">DIRECT</span> No witnesses saw Dino or Robot near cookies<br>
                    <span class="evidence-badge inferential-evidence">INFERENTIAL</span> Bird acting nervous + suspicious "seed crumb" excuse<br>
                    <span class="evidence-badge direct-evidence">DIRECT</span> Crumbs visible on Bird's beak
                </div>
                <div style="margin-top: 15px; font-size: 16px; color: #ff6b9d;">
                    <strong>‚öñÔ∏è JUSTICE DECISION:</strong><br>
                    Bird admits guilt and promises to:<br>
                    1) Share cookies fairly next time<br>
                    2) Ask before taking<br>
                    3) Clean up workshop as community service<br>
                    Fair resolution achieved! ‚öñÔ∏è
                </div>
            `;
            log.appendChild(solution);
            log.scrollTop = log.scrollHeight;
            
            initAudio();
            playTone(523, 0.4, 'sine');
            setTimeout(() => playTone(659, 0.4, 'sine'), 200);
            setTimeout(() => playTone(784, 0.4, 'sine'), 400);
            setTimeout(() => playTone(880, 0.6, 'sine'), 600);
        }
        
        // REASONING CHALLENGE
        let reasoningTimer;
        let reasoningTimeLeft = 30;
        let currentReasoningMode = '';
        let reasoningRoundsWon = 0;
        
        const reasoningChallenges = {
            deductive: {
                clues: [
                    "üìã <strong>RULE:</strong> All cookie thieves have crumbs on them",
                    "üîç <strong>FACT:</strong> Bird has visible crumbs on beak",
                    "üéØ <strong>TASK:</strong> Apply the rule to the fact using deductive logic!"
                ],
                answer: 'bird',
                explanation: "üî¨ DEDUCTIVE WIN! Using the rule 'All thieves have crumbs' + the fact 'Bird has crumbs' = Bird is likely the thief! Like a laser‚Äîprecise logic from general rule to specific conclusion!"
            },
            inductive: {
                clues: [
                    "üîç <strong>PATTERN:</strong> Feather found near cookie jar",
                    "üîç <strong>PATTERN:</strong> Feather on workshop floor",
                    "üîç <strong>PATTERN:</strong> Feathers scattered near crumb trail",
                    "üéØ <strong>TASK:</strong> What do all these feather patterns suggest?"
                ],
                answer: 'bird',
                explanation: "üîÆ INDUCTIVE WIN! Spotting the pattern: Feathers everywhere near the crime scene = Bird was probably there! Like connecting dots to see the big picture and make a prediction!"
            }
        };
        
        function startReasoning(mode) {
            currentReasoningMode = mode;
            reasoningTimeLeft = 30;
            
            const challenge = reasoningChallenges[mode];
            const cluesDiv = document.getElementById('reasoning-clues');
            
            cluesDiv.innerHTML = `
                <h4 style="color: #FFD700; margin-top: 0;">üéØ ${mode.toUpperCase()} REASONING MODE!</h4>
                ${challenge.clues.map(clue => `<div style="margin: 10px 0; font-size: 16px; text-align: left;">${clue}</div>`).join('')}
                <p style="color: #00ffff; margin-top: 15px;">Time is ticking! Use ${mode} logic to identify the culprit!</p>
            `;
            
            document.getElementById('reasoning-result').textContent = 'Timer starting... Make your guess using ' + mode + ' reasoning!';
            document.getElementById('reasoning-result').style.borderColor = '#FFD700';
            
            clearInterval(reasoningTimer);
            reasoningTimer = setInterval(() => {
                reasoningTimeLeft--;
                const timerDisplay = document.getElementById('reasoning-timer');
                timerDisplay.textContent = `‚è∞ Time: ${reasoningTimeLeft}s`;
                
                if (reasoningTimeLeft <= 10) {
                    timerDisplay.style.color = '#ff6b9d';
                }
                
                if (reasoningTimeLeft <= 5) {
                    initAudio();
                    playTone(440, 0.1, 'square');
                }
                
                if (reasoningTimeLeft <= 0) {
                    clearInterval(reasoningTimer);
                    timerDisplay.textContent = '‚è∞ TIME\'S UP!';
                    timerDisplay.style.color = '#ff0000';
                    document.getElementById('reasoning-result').textContent = '‚è∞ Time expired! But that\'s okay‚Äîreasoning takes practice. Try another round!';
                    document.getElementById('reasoning-result').style.borderColor = '#ff6b9d';
                    initAudio();
                    playTone(392, 0.5, 'square');
                }
            }, 1000);
            
            initAudio();
            playTone(523, 0.3, 'sine');
        }
        
        function guessAnswer(guess) {
            if (reasoningTimeLeft <= 0 || !currentReasoningMode) {
                document.getElementById('reasoning-result').textContent = 'Start a reasoning challenge first by clicking a mode button!';
                return;
            }
            
            clearInterval(reasoningTimer);
            
            const challenge = reasoningChallenges[currentReasoningMode];
            const resultDiv = document.getElementById('reasoning-result');
            
            if (guess === challenge.answer) {
                reasoningRoundsWon++;
                resultDiv.innerHTML = `
                    <div style="font-size: 20px; margin-bottom: 10px;">‚úÖ ${challenge.explanation}</div>
                    <div style="font-size: 14px; color: #ffff00;">
                        Time remaining: ${reasoningTimeLeft}s - Excellent detective work! üïµÔ∏è
                    </div>
                `;
                resultDiv.style.background = 'rgba(0, 255, 0, 0.2)';
                resultDiv.style.borderColor = '#00ff00';
                
                document.getElementById('reasoning-score').textContent = `Rounds Won: ${reasoningRoundsWon} üèÜ`;
                
                initAudio();
                playTone(659, 0.3, 'sine');
                setTimeout(() => playTone(784, 0.3, 'sine'), 150);
                setTimeout(() => playTone(880, 0.5, 'sine'), 300);
            } else {
                resultDiv.innerHTML = `
                    <div style="font-size: 18px; color: #ff6b9d;">‚ùå Not quite! The clues point to someone else!</div>
                    <div style="font-size: 14px; margin-top: 10px;">
                        <strong>Hint:</strong> In ${currentReasoningMode === 'deductive' ? 'deductive' : 'inductive'} reasoning, 
                        look for who appears most in the ${currentReasoningMode === 'deductive' ? 'facts matching the rules' : 'repeated patterns'}!
                    </div>
                `;
                resultDiv.style.background = 'rgba(255, 107, 157, 0.2)';
                resultDiv.style.borderColor = '#ff6b9d';
                
                initAudio();
                playTone(349, 0.4, 'square');
            }
            
            document.getElementById('reasoning-timer').textContent = 'üéÆ Ready for another round? Pick a mode!';
            document.getElementById('reasoning-timer').style.color = '#FFD700';
            currentReasoningMode = '';
        }
        
        function loadChapter(num) {
            document.querySelectorAll('.chapter').forEach(ch => ch.style.display = 'none');
            const target = num === 1 ? document.querySelector('.chapter') : document.getElementById('chapter' + num);
            if (target) {
                target.style.display = 'block';
                window.scrollTo(0, 0);
            }
            
            if (num === 1) {
                setTimeout(() => {
                    setupLawCanvas();
                    initAudio();
                }, 100);
            } else if (num === 2) {
                questionsAsked = [];
                document.getElementById('question-log').innerHTML = '<p style="color: #ffff00;">Ask questions by clicking the buttons above! Gather evidence to solve the mystery!</p>';
                reasoningRoundsWon = 0;
                document.getElementById('reasoning-score').textContent = 'Rounds Won: 0';
            }
        }
        
        function celebrateCompletion() {
            initAudio();
            
            // Epic fireworks finale!
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    playTone(523 + Math.random() * 400, 0.3, 'sine');
                    
                    const emojis = ['üéâ', '‚ú®', '‚öñÔ∏è', 'üèÜ', 'üí´', 'üåü'];
                    const fw = document.createElement('div');
                    fw.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                    fw.style.cssText = `
                        position: fixed; 
                        left: ${Math.random() * window.innerWidth}px; 
                        top: ${Math.random() * window.innerHeight}px; 
                        font-size: ${40 + Math.random() * 40}px; 
                        animation: float-up 2.5s ease-out forwards; 
                        pointer-events: none; 
                        z-index: 9999;
                        text-shadow: 0 0 10px #FFD700;
                    `;
                    document.body.appendChild(fw);
                    setTimeout(() => fw.remove(), 2500);
                }, i * 200);
            }
            
            setTimeout(() => {
                alert(`üéâüèÜ CONGRATULATIONS! üèÜüéâ

YOU'VE COMPLETED THE ENTIRE LITTLE X SERIES!

üìö 5 Books Mastered:
‚úÖ Book 1: Foundations & Friendship
‚úÖ Book 2: Creative Building & Music  
‚úÖ Book 3: Web of Life & Science
‚úÖ Book 4: Cosmic Codes & Programming
‚úÖ Book 5: Justice & Reasoning

You've learned:
üåç Environmental Science & Ethics
üíª Programming & Logic
‚öñÔ∏è Justice & Critical Thinking
üé® Creativity & Problem Solving
ü§ù Teamwork & Compassion

You're ready for ANY cosmic adventure!
Keep learning, keep creating, keep being awesome! üöÄ‚ú®`);
            }, 3000);
        }
        
        window.addEventListener('DOMContentLoaded', () => {
            createStars();
            setupLawCanvas();
        });
    </script>
</body>
</html>
